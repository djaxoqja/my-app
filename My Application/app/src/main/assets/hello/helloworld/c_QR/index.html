<html lang="en">
          <head>
            <meta charset="utf-8">

            <title>Html Generated</title>
            <meta name="description" content="Figma htmlGenerator">
            <meta name="author" content="htmlGenerator">
            <link href="https://fonts.googleapis.com/css?family=Alata&display=swap" rel="stylesheet">

            <link rel="stylesheet" href="./styles.css">

            <script src="../setting/theme.js"></script>
            <style>

              body[data-theme="dark-mode"] {
               background-color: #6F727A;
               color: white;
              }
               body[data-theme="light-mode"] {
                 background-color: white;
                 color: #6F727A;;
               }
           </style>

           <script>
            function openChat() {
              // JWT 토큰을 쿠키에서 가져오기
              const token = getCookie('token');  // 예시로 쿠키에서 JWT 토큰 가져오는 함수 사용
          
              if (!token) {
                alert('로그인 정보가 없습니다. 다시 로그인하세요.');
                return;
              }
          
              // API에서 URL을 받아오기 위한 GET 요청
              fetch('https://port-0-findmerestapi-m3fhz3vp2699497a.sel4.cloudtype.app/users/profile/chaturl/', {
                method: 'GET',
                headers: {
                  'Authorization': `Bearer ${token}`,  // Bearer 토큰을 Authorization 헤더에 추가
                  'Content-Type': 'application/json', // 요청 헤더에 Content-Type 추가
                }
              })
                .then(response => {
                  if (!response.ok) {
                    throw new Error('API 요청 실패');
                  }
                  return response.json(); // JSON 응답을 파싱
                })
                .then(data => {
                  // 응답에서 chat_url을 가져옴
                  const chatUrl = data.chat_url;
          
                  if (chatUrl) {
                    // URL이 있을 경우 해당 URL로 리디렉션
                    window.location.href = chatUrl;
                  } else {
                    alert('오픈채팅 URL을 받을 수 없습니다.');
                  }
                })
                .catch(error => {
                  console.error('Error fetching chat URL:', error);
                  alert('오픈채팅 연결에 실패했습니다.');
                });
            }
          
            // 쿠키에서 JWT 토큰을 가져오는 함수
            function getCookie(name) {
              const value = `; ${document.cookie}`;
              const parts = value.split(`; ${name}=`);
              if (parts.length === 2) return parts.pop().split(';').shift();
            }
          </script>

          </head>

          <body>
            <div class=e65_60>
              <div  class="e65_61">

              </div>
              <div  class="e65_62">

              </div>
              <div class=e65_65>
              
              </div>
              <div class=e65_67>
                
              </div>
            <div>

                

          </div>
          <div class=e65_72>
            <div  class="e65_73">

            </div>
            <div class=e65_74>
              <div  class="e65_75">

              </div>
              <div  class="e76_22">

              </div>
            </div>

            <div  class="e65_66">
              <div  class="e65_68">
                <div>
                  <button class="e65_69" onclick="openChat()">오픈채팅 연결</button>
                </div>
              </div>
              
         
            </div>

          <div>
            <button class="e65_77" onclick = "location.href= '../print/index.html';" >QR CODE 출력</button>
          </div>
          <div class=e76_16><div  class="ei76_16_54616_25464"></div></div><div  class="e65_78">

          </div>
          <div class=e65_79>
            <div  class="e65_80">

            </div>
          </div>
        </div>
        <div class=e65_82>
          <div  class="e65_83">

          </div>
          <div  class="e65_84">
            
          </div>
        </div>
        <span  class="e65_85">QR CODE </span>
        <div class=e65_86>
          <div  class="e65_87">

          </div>
            <button class="e65_91" onclick = "location.href= '../select/select.html';" ></button></div><div class=e65_92><div  class="e65_93"></div></div></div>

          <script>

              document.getElementById("openKakaoChatButton").addEventListener("click", function () {
        console.log("버튼 클릭됨 - Android 호출 시도");
        try {
            Android.openKakaoOpenChat();
            console.log("Android.openKakaoOpenChat() 호출 성공");
        } catch (error) {
            console.error("Android.openKakaoOpenChat() 호출 실패:", error);
        }
    });</script>


          </body>
          </html>